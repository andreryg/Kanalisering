<!doctype html>
<html>
    <head>
        <title>Kanalisering</title>
        <link rel="stylesheet" href="viewer.css">
    </head>
    <body>
        <div class=upper>
            <button onclick = "Open();">{X:}</button>
            <button onclick = "ClearStorage();">Clear local storage</button>
        </div>
        <div class=lower>
            <iframe id="Kart" width="100%" height="100%" bottom="0"></iframe>
        </div>
        <script type = "text/javascript">
            
            //Read file into js
            var file = document.getElementById('koordinater.txt');

            file.addEventListener('change', () => {
                var txtArr = [];
                var fr = new FileReader();
                fr.onload = function() {
                    // By lines
                    var lines = this.result.split('\n');
                    for (var line = 0; line < lines.length; line++) {
                        txtArr = [...txtArr, ...(lines[line].split(" "))];
                    }
                }
                fr.onloadend = function() {
                    console.log(txtArr);
                    document.getElementById('output').textContent=txtArr.join("");
                }

                fr.readAsText(file.files[0]);
            })

            console.log(txtArr[0])
            let i = localStorage.getItem("i") ? Number(localStorage.getItem("i")) : 0;
            const koordinat = [[373866,7181599], [237411,6685456], [267411,6985456]]
            var link = `https://vegkart.test.atlas.vegvesen.no/#kartlag:nib/@${koordinat[i][0]},${koordinat[i][1]},18`;
            const Kart = document.getElementById("Kart");
            
            Kart.src = link
            Kart.onload = function() {
                //Kart.contenWindow.scrollTo(100, 100)
                setTimeout(function(){
                    console.log("dog")
                    document.elementFromPoint(300, 30).click()
                }, 8000)
            }

            function ClearStorage() {
                console.log("Cleared")
                window.localStorage.clear();
                location.reload()
                
            }
            function Open() {
                
                ++i;
                localStorage.setItem("i", i)
                console.log(i)
            
                link = `https://vegkart.atlas.vegvesen.no/#kartlag:nib/@${koordinat[i][0]},${koordinat[i][1]},18`;
                Kart.src = link
                location.reload()
            }
        </script>
    </body>
</html>